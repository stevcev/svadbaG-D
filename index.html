<!DOCTYPE html>
<html lang="mk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Гордана & Димитар - 29.08.2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@300;400;700&family=Playfair+Display:ital@0;1&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #d4a3a3; --text: #4a4a4a; --bg: #fff9f9; }
        
        body { 
            font-family: 'Montserrat', sans-serif; 
            margin: 0; padding: 0; color: var(--text);
            overflow-x: hidden; 
            
            /* ЦВЕЌЕТО: Долу Десно */
            background-image: url('https://lh3.googleusercontent.com/d/1Hs4OphR5xPDy8mIaD41I6Q3Z1ZJcH4S7');
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-position: right bottom; 
            background-size: 320px;
        }

        /* ПОЗАДИНА: Ротирана и Зумирана */
        .full-background {
            position: fixed;
            top: -50%; 
            left: -50%; 
            width: 200%; 
            height: 200%;
            background-image: url('https://lh3.googleusercontent.com/d/1F6TSVTgcEkCIyJ9WEon-0r-GG1VCVF-n');
            background-size: cover;
            background-position: center;
            background-repeat: repeat;
            transform: rotate(-10deg) scale(1.2);
            z-index: -5; 
            opacity: 0.6;
        }

        @media (max-width: 600px) { 
            body { background-size: 150px; } 
            .full-background { transform: rotate(-10deg) scale(1.5); }
        }

        .page { display: none; padding: 20px; animation: fadeIn 0.8s ease-in-out; text-align: center; position: relative; z-index: 1; }
        .active { display: block; }

        .main-header-img { transition: all 0.5s ease; display: block; margin: 10px auto; max-width: 95%; }
        .img-large { width: 600px; }
        .img-small { width: 240px; }

        .hero h2 { font-family: 'Playfair Display', serif; font-size: 1.2rem; font-style: italic; letter-spacing: 2px; background: rgba(255,255,255,0.7); display: inline-block; padding: 5px 15px; border-radius: 10px; }
        
        .timer-container { margin: 20px auto; background: rgba(255, 255, 255, 0.9); padding: 15px; border-radius: 15px; max-width: 400px; border: 1px solid var(--accent); }
        #countdown { font-family: 'Playfair Display', serif; font-size: 1.4rem; font-weight: bold; }
        
        .nav-buttons { display: flex; flex-direction: column; gap: 10px; align-items: center; margin-top: 20px; }
        .btn { width: 280px; padding: 14px; font-size: 14px; border: 1px solid var(--accent); background: white; color: var(--text); cursor: pointer; border-radius: 5px; transition: 0.4s; font-weight: bold; letter-spacing: 1px; text-decoration: none; display: inline-block; box-sizing: border-box; }
        .btn:hover { background: var(--accent); color: white; }
        
        .content-box { max-width: 600px; margin: auto; background: rgba(255, 255, 255, 0.95); padding: 25px; border-radius: 5px; box-shadow: 0 10px 30px rgba(212, 163, 163, 0.15); border: 1px solid #f2e4e4; }
        .btn-back { margin-top: 20px; background: none; border: none; color: var(--accent); text-decoration: underline; cursor: pointer; display: block; margin: 20px auto; }
        
        input, textarea, select { width: 95%; padding: 12px; margin: 10px 0; border: 1px solid var(--accent); border-radius: 5px; font-family: 'Montserrat', sans-serif; }
        #messagesList { text-align: left; margin-top: 20px; max-height: 350px; overflow-y: auto; border-top: 1px solid #eee; padding-top: 10px; }
        
        /* HAMBURGER MENU STYLES */
        .hamburger {
            font-size: 35px;
            cursor: pointer;
            position: fixed;
            top: 15px;
            left: 20px;
            z-index: 100;
            color: var(--accent);
            display: none; 
            background: rgba(255,255,255,0.7);
            padding: 5px 10px;
            border-radius: 5px;
        }

        .sidenav {
            height: 100%;
            width: 0;
            position: fixed;
            z-index: 101;
            top: 0;
            left: 0;
            background-color: #fff;
            overflow-x: hidden;
            transition: 0.5s;
            padding-top: 60px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .sidenav a {
            padding: 8px 8px 8px 32px;
            text-decoration: none;
            font-size: 20px;
            color: var(--text);
            display: block;
            transition: 0.3s;
            font-family: 'Playfair Display', serif;
            border-bottom: 1px solid #eee;
        }

        .sidenav a:hover { color: var(--accent); }
        .sidenav .closebtn {
            position: absolute;
            top: 0;
            right: 25px;
            font-size: 36px;
            margin-left: 50px;
            border-bottom: none;
        }

        /* Suggestion Box Styles */
        #suggestionBox {
            display: none;
            margin-top: 15px;
            padding: 10px;
            background-color: #fef4f4;
            border: 1px dashed var(--accent);
            border-radius: 5px;
            text-align: left;
        }
        .suggestion-link {
            color: var(--accent);
            font-weight: bold;
            text-decoration: underline;
            cursor: pointer;
            font-size: 1.1rem;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="full-background"></div>

    <span id="navIcon" class="hamburger" onclick="openNav()">☰</span>

    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
        <a href="#" onclick="showPage('homePage'); closeNav()">Почетна</a>
        <a href="#" onclick="showPage('tablePage'); closeNav()">Најди маса</a>
        <a href="#" onclick="showPage('menuPage'); closeNav()">Мени</a>
        <a href="#" onclick="showPage('bandPage'); closeNav()">Музика</a>
        <a href="#" onclick="showPage('galleryPage'); closeNav()">Галерија</a>
        <a href="#" onclick="showPage('guestbookPage'); closeNav()">Впечатоци</a>
    </div>

    <img id="mainLogo" src="https://lh3.googleusercontent.com/d/1yipa967Mr0LG5l5I6H3im9NQV3clCiId" class="main-header-img img-large" alt="Гордана и Димитар">

    <div id="homePage" class="page active">
        <div class="hero">
            <h2>29.08.2026 • 19:00ч</h2>
            <div class="timer-container"><div id="countdown">Се вчитавува...</div></div>
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('tablePage')">НАЈДИ ЈА ТВОЈАТА МАСА</button>
                <button class="btn" onclick="showPage('menuPage')">ПОГЛЕДНИ ГО МЕНИТО</button>
                <button class="btn" onclick="showPage('bandPage')">ЗА ЗАБАВАТА</button>
                <button class="btn" onclick="showPage('galleryPage')">ГАЛЕРИЈА СО СЛИКИ</button>
                <button class="btn" onclick="showPage('guestbookPage')">КНИГА НА ВПЕЧАТОЦИ</button>
            </div>
            <div style="max-width:600px; margin: 40px auto; padding: 20px; border-top: 1px solid var(--accent); background: rgba(255,255,255,0.8); border-radius: 10px;">
                <h3 style="font-family: 'Great Vibes', cursive; font-size: 2.5rem; color: var(--accent);">Нашата Приказна</h3>
                <p style="font-style: italic; color: #666;">
                    Добредојдовте во нашата дигитална покана! Се радуваме што ќе го споделиме овој посебен ден со вас. 
                    Овде можете да ги најдете сите потребни информации за прославата.
                </p>
            </div>
        </div>
    </div>

    <div id="tablePage" class="page">
        <div class="content-box">
            <h2 style="font-family: 'Playfair Display', serif; color: var(--accent);">Вашата Маса</h2>
            <input type="text" id="guestNameSearch" placeholder="Внесете Име и Презиме">
            <div style="background: #fff; padding: 10px; border: 1px solid #eee; margin: 10px 0;">
                <canvas id="captchaCanvas" width="150" height="50" onclick="generateCaptcha()"></canvas>
                <input type="text" id="captchaInput" placeholder="Код од сликата">
            </div>
            <button class="btn" style="width:100%; background: var(--accent); color: white;" onclick="findTable()">ПРЕБАРАЈ</button>
            
            <div id="suggestionBox">
                Дали мислевте на: <span id="suggestedName" class="suggestion-link" onclick="applySuggestion()"></span> ?
            </div>

            <div id="result" style="display:none; margin-top: 25px;">
                <h3 id="welcomeMsg" style="font-family: 'Great Vibes', cursive; font-size: 2rem;"></h3>
                <div style="font-size: 2rem; font-weight: bold; color: var(--accent);" id="tableNumResult"></div>
                <div id="otherGuests" style="text-align: left; padding: 15px; background: #fff9f9; border-left: 2px solid var(--accent); margin-top: 10px;"></div>
            </div>
            <button class="btn-back" onclick="showPage('homePage')">← НАЗАД</button>
        </div>
    </div>

    <div id="menuPage" class="page">
        <div class="content-box">
            <h2 style="font-family: 'Great Vibes', cursive; font-size: 3rem; color: var(--accent);">Свадбено Мени</h2>
            <div style="text-align: left; line-height: 1.8; font-family: 'Playfair Display', serif;">
                <p><strong>1. Ладно предјадење:</strong> Македонска даска</p>
                <p><strong>2. Салата:</strong> Шопска салата</p>
                <p><strong>3. Топло предјадење:</strong> Сармички и похуван кашкавал</p>
                <p><strong>4. Главно јадење:</strong> Мешана скара и печен компир</p>
                <p><strong>5. Десерт:</strong> Свадбена торта</p>
            </div>
            <button class="btn-back" onclick="showPage('homePage')">← НАЗАД</button>
        </div>
    </div>

    <div id="bandPage" class="page">
        <div class="content-box">
            <h2 style="font-family: 'Great Vibes', cursive; font-size: 3rem; color: var(--accent);">За забавата...</h2>
            <p>За подиумот да биде постојано полн, задолжени се нашите пријатели од <strong>Бенд Панта Реи</strong>.</p>
            <a href="https://www.facebook.com/pantareiband/" target="_blank" class="btn" style="width: auto; padding: 14px 20px;">Посетете го нивниот профил</a>
            <button class="btn-back" onclick="showPage('homePage')">← НАЗАД</button>
        </div>
    </div>

    <div id="galleryPage" class="page">
        <div class="content-box" style="max-width: 800px;">
            <h2 style="font-family: 'Great Vibes', cursive; font-size: 3rem; color: var(--accent);">Галерија</h2>
            <iframe src="https://drive.google.com/embeddedfolderview?id=1myuoQARxyfqchMvi-iQaDL5-lJh9BMBkILR7LhTXvcquzGL-l0h0IWaqsRYrVlwF60G3wEiM#grid" style="width: 100%; height: 400px; border: none; border-radius: 10px; background: #eee;"></iframe>
            
            <div style="margin-top: 30px; padding: 20px; border: 1px dashed var(--accent); border-radius: 10px; background: #fffcfc;">
                <h4>Споделете моменти со нас</h4>
                <div id="uploadCaptchaArea">
                    <canvas id="uploadCaptchaCanvas" width="150" height="50" onclick="generateUploadCaptcha()" style="cursor:pointer; border:1px solid #ddd;"></canvas>
                    <input type="text" id="uploadCaptchaInput" placeholder="Код од сликата">
                    <button class="btn" style="width:100%;" onclick="verifyAndUpload()">ПРИКАЧИ ФАЈЛ</button>
                </div>
                <div id="uploadLink" style="display: none;">
                    <p style="color: green; font-weight: bold;">✅ Кодот е точен!</p>
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSe6-d0ZnfiLBh57pvsQNZAPXI3jB9RKg3oOJaupEsww6X2Qyg/viewform" target="_blank" class="btn" style="width: 100%; background: var(--accent); color: white;">КЛИКНИ ТУКА ЗА ПРИКАЧУВАЊЕ</a>
                </div>
            </div>
            <button class="btn-back" onclick="showPage('homePage')">← НАЗАД</button>
        </div>
    </div>

    <div id="guestbookPage" class="page">
        <div class="content-box">
            <h2 style="font-family: 'Great Vibes', cursive; font-size: 3rem; color: var(--accent);">Вашите Желби</h2>
            <div style="text-align: left;">
                <label>Број на вашата маса:</label>
                <input type="number" id="guestbookTableNum" placeholder="пр. 1" oninput="filterGuestNames()">
                <label>Изберете го вашето име:</label>
                <select id="visitorNameSelect"><option value="">-- Внеси број на маса --</option></select>
                <label>Вашата порака:</label>
                <textarea id="visitorMessage" placeholder="Напишете нешто убаво..."></textarea>
                <button id="sendBtn" class="btn" style="width:100%; background: var(--accent); color: white;" onclick="postMessage()">ОБЈАВИ</button>
            </div>
            <div id="messagesList">Се вчитавуваат пораките...</div>
            <button class="btn-back" onclick="showPage('homePage')">← НАЗАД</button>
        </div>
    </div>

    <script>
        const apiURL = "https://sheetdb.io/api/v1/z8rku0vozkyiq";
        const weddingDate = new Date("August 29, 2026 19:00:00").getTime();

        const guestList = [
            { name: "Гордана Стевчева", table: 1 }, { name: "Димитар Стевчев", table: 1 },
            { name: "Ѓоке Гргушовски", table: 1 }, { name: "Памела Ристова", table: 1 },
            { name: "Васко Стевчев", table: 2 }, { name: "Габриела Стевчева", table: 2 },
            { name: "Кристина Димитрова", table: 2 }, { name: "Роберт Димитров", table: 2 },
            { name: "Василиј Димитров", table: 2 }, { name: "Спасија Димитрова", table: 2 },
            { name: "Љупче Василев", table: 2 }, { name: "Јосиф Крстев", table: 3 },
            { name: "Славица Крстева", table: 3 }, { name: "Кристина Крстева", table: 3 },
            { name: "Славко Расточиќ", table: 3 }
        ];

        function openNav() { document.getElementById("mySidenav").style.width = "250px"; }
        function closeNav() { document.getElementById("mySidenav").style.width = "0"; }

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            
            const logo = document.getElementById('mainLogo');
            const navIcon = document.getElementById('navIcon');

            if(pageId === 'homePage') {
                logo.classList.replace('img-small', 'img-large');
                navIcon.style.display = 'none';
            } else {
                logo.classList.replace('img-large', 'img-small');
                navIcon.style.display = 'block';
                if(pageId === 'guestbookPage') loadMessages();
                if(pageId === 'tablePage') generateCaptcha();
                if(pageId === 'galleryPage') generateUploadCaptcha();
            }
            window.scrollTo(0, 0);
        }

        setInterval(() => {
            const now = new Date().getTime();
            const d = weddingDate - now;
            if (d < 0) { document.getElementById("countdown").innerHTML = "Свадбата започна!"; return; }
            document.getElementById("countdown").innerHTML = Math.floor(d/(1000*60*60*24)) + "д " + Math.floor((d%(1000*60*60*24))/(1000*60*60)) + "ч " + Math.floor((d%(1000*60*60))/(1000*60)) + "м " + Math.floor((d%(1000*60))/1000) + "с";
        }, 1000);

        function filterGuestNames() {
            const tableNum = parseInt(document.getElementById('guestbookTableNum').value);
            const select = document.getElementById('visitorNameSelect');
            select.innerHTML = '<option value="">-- Избери име --</option>';
            guestList.filter(g => g.table === tableNum).forEach(g => {
                const opt = document.createElement('option'); opt.value = g.name; opt.textContent = g.name; select.appendChild(opt);
            });
        }

        function loadMessages() {
            fetch(apiURL).then(r => r.json()).then(data => {
                const list = document.getElementById('messagesList');
                list.innerHTML = data.length === 0 ? "Бидете први што ќе остават порака!" : "";
                data.reverse().forEach(item => {
                    const div = document.createElement('div');
                    div.style.cssText = "border-bottom: 1px solid #f2e4e4; padding: 12px 0;";
                    div.innerHTML = `<strong style="color:var(--accent)">${item.name}:</strong><p style="font-style:italic; margin:5px 0;">${item.message}</p><small style="color:#bbb; font-size:0.7rem;">${item.date || ""}</small>`;
                    list.appendChild(div);
                });
            });
        }

        function postMessage() {
            const name = document.getElementById('visitorNameSelect').value;
            const msg = document.getElementById('visitorMessage').value;
            const now = new Date();
            const dateStr = now.toLocaleDateString('mk-MK') + " " + now.toLocaleTimeString('mk-MK', {hour:'2-digit', minute:'2-digit'});
            if(!name || !msg) return alert("Изберете име и порака!");
            
            fetch(apiURL, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({data: [{name, message: msg, date: dateStr}]})
            }).then(() => {
                document.getElementById('visitorMessage').value = "";
                loadMessages();
            });
        }

        let currentCaptcha = "", currentUploadCaptcha = "";
        function generateCaptcha() {
            const canvas = document.getElementById("captchaCanvas");
            const ctx = canvas.getContext("2d");
            currentCaptcha = Math.random().toString(36).substring(2, 7).toUpperCase();
            ctx.clearRect(0,0,150,50); ctx.font="bold 24px Arial"; ctx.fillStyle="#d4a3a3"; ctx.fillText(currentCaptcha, 35, 35);
        }
        function generateUploadCaptcha() {
            const canvas = document.getElementById("uploadCaptchaCanvas");
            const ctx = canvas.getContext("2d");
            currentUploadCaptcha = Math.random().toString(36).substring(2, 7).toUpperCase();
            ctx.clearRect(0,0,150,50); ctx.font="bold 24px Arial"; ctx.fillStyle="#d4a3a3"; ctx.fillText(currentUploadCaptcha, 35, 35);
        }
        function verifyAndUpload() {
            if (document.getElementById('uploadCaptchaInput').value.toUpperCase() === currentUploadCaptcha) {
                document.getElementById('uploadCaptchaArea').style.display = 'none';
                document.getElementById('uploadLink').style.display = 'block';
            } else { alert("Погрешен код!"); generateUploadCaptcha(); }
        }

        function simplify(t) {
            const map = {'а':'a','б':'b','в':'v','г':'g','д':'d','ѓ':'gj','е':'e','ж':'zh','з':'z','ѕ':'dz','и':'i','ј':'j','к':'k','л':'l','љ':'lj','м':'m','н':'n','њ':'nj','о':'o','п':'p','р':'r','с':'s','т':'t','ќ':'kj','у':'u','ф':'f','х':'h','ц':'c','ч':'ch','џ':'dz','ш':'sh'};
            return t.toLowerCase().trim().split('').map(c => map[c] || c).join('').replace(/ch/g,'c').replace(/sh/g,'s');
        }

        // Levenshtein Algorithm for Fuzzy Match
        function levenshtein(a, b) {
            const matrix = [];
            for(let i=0; i<=b.length; i++) matrix[i] = [i];
            for(let j=0; j<=a.length; j++) matrix[0][j] = j;
            for(let i=1; i<=b.length; i++){
                for(let j=1; j<=a.length; j++){
                    if(b.charAt(i-1) == a.charAt(j-1)) matrix[i][j] = matrix[i-1][j-1];
                    else matrix[i][j] = Math.min(matrix[i-1][j-1] + 1, Math.min(matrix[i][j-1] + 1, matrix[i-1][j] + 1));
                }
            }
            return matrix[b.length][a.length];
        }

        let pendingSuggestion = "";

        function findTable(skipCaptcha = false) {
            if(!skipCaptcha && document.getElementById('captchaInput').value.toUpperCase() !== currentCaptcha) return alert("Погрешен код!");
            
            const inputRaw = document.getElementById('guestNameSearch').value;
            const inputSimple = simplify(inputRaw);
            
            // 1. Точно совпаѓање
            const guest = guestList.find(g => simplify(g.name) === inputSimple);

            document.getElementById('result').style.display = 'none';
            document.getElementById('suggestionBox').style.display = 'none';

            if(guest) {
                document.getElementById('welcomeMsg').innerText = "Здраво, " + guest.name;
                document.getElementById('tableNumResult').innerText = "МАСА " + guest.table;
                const mates = guestList.filter(g => g.table === guest.table && g.name !== guest.name);
                document.getElementById('otherGuests').innerHTML = "<strong>На вашата маса:</strong><br>" + (mates.map(m => "• " + m.name).join('<br>'));
                document.getElementById('result').style.display = 'block';
            } else {
                // 2. Fuzzy пребарување (Грешка во пишување)
                let bestMatch = null;
                let minDistance = Infinity;

                guestList.forEach(g => {
                    const dist = levenshtein(inputSimple, simplify(g.name));
                    // Дозволуваме мала грешка (помала или еднаква на 3 карактери)
                    if (dist < minDistance && dist <= 3) {
                        minDistance = dist;
                        bestMatch = g;
                    }
                });

                if (bestMatch) {
                    pendingSuggestion = bestMatch.name;
                    document.getElementById('suggestedName').innerText = bestMatch.name;
                    document.getElementById('suggestionBox').style.display = 'block';
                } else {
                    alert("Името не е пронајдено.");
                }
            }
        }

        function applySuggestion() {
            document.getElementById('guestNameSearch').value = pendingSuggestion;
            findTable(true); // Пребарај повторно, скокни капча бидејќи веќе ја поминал корисникот
        }
    </script>
</body>
</html>